########################################
#OE_Receiving_Rest.properties
########################################
PHYSICAL_INVENTORY_INITIAL_CONTEXT_FACTORY = com.ibm.websphere.naming.WsnInitialContextFactory
PHYSICAL_INVENTORY_PROVIDER_URL = iiop://localhost:7352
PHYSICAL_INVENTORY_JNDI_NAME = ejblocal:com.cardinal.ws.physicalinventory.PhysicalInventoryPersisterBeanLocal

PURCH_HIST_SERVICE_ENDPOINT = http://oews.appzone.dmz/GetPrchseHistWeb/services/GetPurchaseHistoryService_v_1_1

PHYSICAL_INVENTORY_JNDI_PI = jdbc/OE_PI


QUERY_PD=WITH POSSIBLE_APU_RECORDS AS ( SELECT \
   ACC1.AMU_CALC_TYPE_CDE AS ACCOUNT_RECORD_AMU_CALC_TYPE_CDE, \
   APU1.AMU_CALC_TYPE_CDE AS APU_RECORD_AMU_CALC_TYPE_CDE, \
   APU1.CORP_ITEM_NUM,\
   CASE \
      WHEN APU1.AMU_CALC_TYPE_CDE = ACC1.AMU_CALC_TYPE_CDE THEN 1 \
      ELSE 2 \
   END AS PAR_RANK_CDE \
FROM \
   HSCSP_DDS.ACCOUNTS ACC1 \
INNER JOIN \
   HSCSP_ODS.ACCT_PROD_USAGE APU1 \
      ON ACC1.SHIP_TO_CUSTOMER_NUM = COALESCE (APU1.SHIP_TO_CUSTOMER_NUM ,\
   APU1.SHIP_TO_CUSTOMER_NUM) \
   AND ACC1.SHIP_TO_LOCATION_NUM = APU1.SHIP_TO_LOCATION_NUM \
WHERE \
   COALESCE(ACC1.SHIP_TO_CUSTOMER_NUM, ACC1.SHIP_TO_CUSTOMER_NUM) = ?  \
   AND ACC1.SHIP_TO_LOCATION_NUM = ?  \
   AND APU1.CORP_ITEM_NUM <varCIN> )\
   ,PRD_ON_PD AS  (SELECT \
   prd.CORP_ITEM_NUM as PDCIN \
FROM \
   HSCSP_DDS.PRODUCT prd,\
   HSCSP_DDS.SPD_PRD_ON_PD_CNTRT pl   \
WHERE \
   pl.CORP_ITEM_NUM = prd.CORP_ITEM_NUM \
   and pl.SHIP_TO_CUSTOMER_NUM= ? \
   and pl.SHIP_TO_LOCATION_NUM = ? \
   AND prd.CORP_ITEM_NUM <varCIN>  \
UNION \
SELECT \
   prd.CORP_ITEM_NUM as PDCIN \
FROM \
   HSCSP_DDS.PRODUCT prd,\
   HSCSP_SPD_DDS.PRODUCT spd,\
   HSCSP_SPD_DDS.GPO GPO,\
   HSCSP_SPD_DDS.EXTERNAL_PRODUCT_DATA EXPSPD,\
   HSCSP_SPD_DDS.ACCOUNTS SPDACC,\
   HSCSP_DDS.PD_SPD_ACCT_RLT XREF \
WHERE \
   XREF.PD_SHIP_TO_CUST_NUM =? \
   and XREF.PD_SHIP_TO_LOC_NUM = ?  \
   and spd.PD_CORP_ITEM_NUM = prd.CORP_ITEM_NUM \
   and SPDACC.SHIP_TO_CUST_NUM = XREF.SPD_SHIP_TO_CUST_NUM   \
   AND SPDACC.SHIP_TO_LOC_NUM = XREF.SPD_SHIP_TO_LOC_NUM \
   and GPO.GPO_ID = SPDACC.GPO_ID \
   AND GPO.EXCP_FLG = 'Y'   \
   AND EXPSPD.CORP_ITEM_NUM = spd.CORP_ITEM_NUM \
   AND EXPSPD.HAM_DEPT_NUM != 1005 \
   AND prd.CORP_ITEM_NUM NOT IN   (Select \
      pl.CORP_ITEM_NUM \
   from \
      HSCSP_DDS.SPD_PRD_ON_PD_CNTRT pl \
   where \
      pl.SHIP_TO_CUSTOMER_NUM = ? \
      and pl.SHIP_TO_LOCATION_NUM = ? )   \
   AND prd.CORP_ITEM_NUM <varCIN> ),   APE_DATA AS ( SELECT \
      pd.PDCIN AS PDCIN, \
      APE.SELL_PRICE_DLR \
   FROM \
      PRD_ON_PD pd   \
   LEFT OUTER JOIN \
      HSCSP_ODS.ACCT_PROD_ELIGIBILITY APE \
         ON pd.PDCIN = APE.CORP_ITEM_NUM \
         AND APE.SHIP_TO_CUSTOMER_NUM= ? \
         AND APE.SHIP_TO_LOCATION_NUM= ?   \
   LEFT OUTER JOIN \
      HSCSP_DDS.PD_SPD_ACCT_RLT XREF \
         ON XREF.PD_SHIP_TO_CUST_NUM = APE.SHIP_TO_CUSTOMER_NUM \
         and XREF.PD_SHIP_TO_LOC_NUM = APE.SHIP_TO_LOCATION_NUM   \
   LEFT OUTER JOIN \
      HSCSP_SPD_DDS.PRODUCT SPD \
         ON SPD.PD_CORP_ITEM_NUM = APE.CORP_ITEM_NUM \
   LEFT OUTER JOIN \
      HSCSP_SPD_ODS.ACCT_PROD_ELIGIBILITY SAPE \
         ON   SAPE.SHIP_TO_CUST_NUM = XREF.SPD_SHIP_TO_CUST_NUM \
         AND SAPE.SHIP_TO_LOC_NUM = XREF.SPD_SHIP_TO_LOC_NUM \
         AND SAPE.CORP_ITEM_NUM = SPD.CORP_ITEM_NUM \
   LEFT OUTER JOIN \
      HSCSP_DDS.ACCOUNTS ACC2 \
         ON APE.SHIP_TO_CUSTOMER_NUM= ACC2.SHIP_TO_CUSTOMER_NUM \
         AND APE.SHIP_TO_LOCATION_NUM= ACC2.SHIP_TO_LOCATION_NUM     \
   UNION \
   SELECT \
      SPD.PD_CORP_ITEM_NUM AS PDCIN,\
      APE.SELL_PRICE_DLR \
   FROM \
      HSCSP_SPD_DDS.PRODUCT SPD   \
   LEFT OUTER JOIN \
      HSCSP_SPD_ODS.ACCT_PROD_ELIGIBILITY SAPE \
         ON SAPE.CORP_ITEM_NUM = SPD.CORP_ITEM_NUM \
   INNER JOIN \
      HSCSP_DDS.PD_SPD_ACCT_RLT XREF \
         ON SAPE.SHIP_TO_CUST_NUM = XREF.SPD_SHIP_TO_CUST_NUM   \
         AND SAPE.SHIP_TO_LOC_NUM = XREF.SPD_SHIP_TO_LOC_NUM \
         AND XREF.PD_SHIP_TO_CUST_NUM = ? \
         and XREF.PD_SHIP_TO_LOC_NUM = ? \
   LEFT OUTER JOIN \
      HSCSP_ODS.ACCT_PROD_ELIGIBILITY APE \
         ON SPD.PD_CORP_ITEM_NUM = APE.CORP_ITEM_NUM   \
         AND APE.SHIP_TO_CUSTOMER_NUM = XREF.SPD_SHIP_TO_CUST_NUM \
         AND APE.SHIP_TO_LOCATION_NUM = 80 \
   where \
      SPD.PD_CORP_ITEM_NUM NOT IN (select \
         pd.PDCIN \
      from \
         PRD_ON_PD pd) \
      and SPD.PD_CORP_ITEM_NUM <varCIN> ) \
   SELECT \
   DISTINCT  P.CORP_ITEM_NUM,\
   P.CURR_CORP_NIFO_DLR,\
   APE.SELL_PRICE_DLR, \
   ASA.DEFAULT_UOIF_TYPE_CDE,\
   PCA.UOIF_NUM,\
   APU2.LAST_PAID_COST_DLR,\
   P.UNIT_H_ID,\
   P.PACK_QTY,\
   P.PACK_SIZE_QTY,\
   CASE \
      WHEN UOIF_RULE_CNDTN_CDE = 1 THEN  CASE \
         WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY \
         WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
         WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
         ELSE -1 \
      END \
      WHEN UOIF_RULE_CNDTN_CDE = 2 THEN CASE \
         WHEN UOIF_PACK_CNDTN_CDE = 1 \
         AND P.PACK_QTY = 1 THEN CASE \
            WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY \
            WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
            WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
            ELSE -1 \
         END \
         WHEN UOIF_PACK_CNDTN_CDE = 1  \
         AND P.PACK_QTY >1 THEN  CASE \
            WHEN UOIF_RULE_TYPE_2_CDE = 1 THEN P.PACK_SIZE_QTY   \
            WHEN UOIF_RULE_TYPE_2_CDE = 2 THEN P.PACK_QTY  \
            WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN  P.PACK_SIZE_QTY*P.PACK_QTY  \
            ELSE -1 \
         END \
         WHEN UOIF_PACK_CNDTN_CDE = 2  \
         AND P.PACK_QTY = 1 THEN CASE \
            WHEN UOIF_RULE_TYPE_2_CDE = 1 THEN P.PACK_SIZE_QTY  \
            WHEN UOIF_RULE_TYPE_2_CDE = 2 THEN P.PACK_QTY  \
            WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
            ELSE -1 \
         END \
         WHEN UOIF_PACK_CNDTN_CDE = 2  \
         AND P.PACK_QTY >1 THEN CASE \
            WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY \
            WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
            WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
            ELSE -1 \
         END \
         ELSE -1 \
      END \
      ELSE -2 \
   END AS FORM_UOIF  \
FROM \
   HSCSP_DDS.PRODUCT_DATA_MQT P  \
INNER JOIN \
   HSCSP_DDS.ACCOUNTS ACC2  \
      ON ACC2.SHIP_TO_CUSTOMER_NUM= ? \
      AND ACC2.SHIP_TO_LOCATION_NUM = ? \
LEFT OUTER JOIN \
   (\
      SELECT \
         APU_RECORD_AMU_CALC_TYPE_CDE,\
         PAR2.CORP_ITEM_NUM  \
      FROM \
         POSSIBLE_APU_RECORDS PAR2   \
      INNER JOIN \
         (\
            SELECT \
               MIN(PAR_RANK_CDE) as PAR_RANK_CDE,\
               CORP_ITEM_NUM  \
            FROM \
               POSSIBLE_APU_RECORDS  \
            group by \
               CORP_ITEM_NUM\
         ) as TEMP1  \
            ON PAR2.PAR_RANK_CDE = TEMP1.PAR_RANK_CDE  \
            AND PAR2.CORP_ITEM_NUM = TEMP1.CORP_ITEM_NUM \
         ) PAR1  \
            ON PAR1.CORP_ITEM_NUM = P.CORP_ITEM_NUM   \
      LEFT OUTER JOIN \
         HSCSP_CMDS.PRODUCT_CUSTOM_ATTRIBUTE PCA  \
            ON PCA.CORP_ITEM_NUM = P.CORP_ITEM_NUM \
            AND PCA.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM \
            AND PCA.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM  \
            AND PCA.SHIP_TO_CUSTOMER_NUM = COALESCE(PCA.SHIP_TO_CUSTOMER_NUM ,\
         PCA.SHIP_TO_CUSTOMER_NUM) \
      LEFT OUTER JOIN \
         HSCSP_ODS.ACCT_PROD_USAGE APU2  \
            ON APU2.CORP_ITEM_NUM = P.CORP_ITEM_NUM  \
            AND APU2.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM \
            AND APU2.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM  \
            AND APU2.AMU_CALC_TYPE_CDE = PAR1.APU_RECORD_AMU_CALC_TYPE_CDE \
      LEFT OUTER JOIN \
         HSCSP_ODS.ACCT_PROD_ELIGIBILITY APE  \
            ON APE.SHIP_TO_CUSTOMER_NUM =ACC2.PRICE_SHIP_TO_CUSTOMER_NUM  \
            AND APE.SHIP_TO_LOCATION_NUM = ACC2.PRICE_SHIP_TO_LOCATION_NUM   \
            AND APE.CORP_ITEM_NUM = P.CORP_ITEM_NUM \
      LEFT OUTER JOIN \
         HSCSP_CMDS.ACCT_STNG_ATRBT ASA  \
            ON ASA.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM  \
            AND ASA.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM \
      LEFT OUTER JOIN \
         (\
            SELECT \
               AGFR.FORM_ID,\
               AGRR.*  \
            FROM \
               HSCSP_CMDS.UOIF_ACCT_GROUP AG  \
            INNER JOIN \
               HSCSP_CMDS.UOIF_ACCT_GROUP_RULE_RLT AGRR  \
                  ON AG.ACCT_GROUP_NUM = AGRR.ACCT_GROUP_NUM  \
            INNER JOIN \
               HSCSP_CMDS.UOIF_ACCT_GROUP_FORM_RLT AGFR  \
                  ON AG.ACCT_GROUP_NUM = AGFR.ACCT_GROUP_NUM \
            where \
               AG.SHIP_TO_CUSTOMER_NUM = ? \
               and AG.SHIP_TO_LOCATION_NUM = ?\
         ) as TEMP2  \
            ON P.FORM_ID = TEMP2.FORM_ID  \
        WHERE \
        P.CORP_ITEM_NUM IN ( \
                  SELECT CORP_ITEM_NUM FROM HSCSP_DDS.PRODUCT where ITEM_TYPE_CDE <> 24 and CORP_ITEM_NUM  <varCIN> \
               ) \      


QUERY_SPD=SELECT \
         DISTINCT   P.CORP_ITEM_NUM, \
         P.CURR_CORP_NIFO_DLR,\
         APE.SELL_PRICE_DLR,\
         ASA.DEFAULT_UOIF_TYPE_CDE,\
         PCA.UOIF_NUM,\
         APU2.LAST_PAID_COST_DLR, \
         P.UNIT_H_ID,\
         P.PACK_QTY,\
         P.PACK_SIZE_QTY, CASE \
            WHEN UOIF_RULE_CNDTN_CDE = 1 THEN  CASE \
               WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY  \
               WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
               WHEN UOIF_RULE_TYPE_1_CDE = 3   THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
               ELSE -1 \
            END \
            WHEN UOIF_RULE_CNDTN_CDE = 2 THEN CASE \
               WHEN UOIF_PACK_CNDTN_CDE = 1  \
               AND P.PACK_QTY = 1 THEN CASE \
                  WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY   \
                  WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
                  WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
                  ELSE -1 \
               END \
               WHEN UOIF_PACK_CNDTN_CDE = 1  \
               AND P.PACK_QTY >1 THEN CASE \
                  WHEN UOIF_RULE_TYPE_2_CDE = 1  THEN P.PACK_SIZE_QTY  \
                  WHEN UOIF_RULE_TYPE_2_CDE = 2 THEN P.PACK_QTY  \
                  WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
                  ELSE -1 \
               END \
               WHEN UOIF_PACK_CNDTN_CDE = 2  \
               AND P.PACK_QTY = 1   THEN CASE \
                  WHEN UOIF_RULE_TYPE_2_CDE = 1 THEN P.PACK_SIZE_QTY  \
                  WHEN UOIF_RULE_TYPE_2_CDE = 2 THEN P.PACK_QTY  \
                  WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
                  ELSE -1 \
               END \
               WHEN UOIF_PACK_CNDTN_CDE = 2    \
               AND P.PACK_QTY >1 THEN CASE \
                  WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_QTY  \
                  WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY  \
                  WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_QTY*P.PACK_QTY  \
                  ELSE -1 \
               END \
               ELSE -1  \
            END \
            ELSE -2 \
         END AS FORM_UOIF  \
      FROM \
         HSCSP_DDS.PRODUCT_DATA_MQT P  \
      INNER JOIN \
         HSCSP_DDS.ACCOUNTS ACC2  \
            ON ACC2.SHIP_TO_CUSTOMER_NUM = ?   \
            AND ACC2.SHIP_TO_LOCATION_NUM = ?  \
      LEFT OUTER JOIN \
         (\
            SELECT \
               APU_RECORD_AMU_CALC_TYPE_CDE,\
               PAR2.CORP_ITEM_NUM  \
            FROM \
               POSSIBLE_APU_RECORDS PAR2  \
            INNER JOIN \
               (\
                  SELECT \
                     MIN(PAR_RANK_CDE) as PAR_RANK_CDE, \
                     CORP_ITEM_NUM  \
                  FROM \
                     POSSIBLE_APU_RECORDS   \
                  group by \
                     CORP_ITEM_NUM\
               ) as TEMP1  \
                  ON PAR2.PAR_RANK_CDE = TEMP1.PAR_RANK_CDE  \
                  AND PAR2.CORP_ITEM_NUM = TEMP1.CORP_ITEM_NUM\
               ) PAR1  \
                  ON PAR1.CORP_ITEM_NUM = P.CORP_ITEM_NUM   \
            LEFT OUTER JOIN \
               HSCSP_CMDS.PRODUCT_CUSTOM_ATTRIBUTE PCA  \
                  ON PCA.CORP_ITEM_NUM = P.CORP_ITEM_NUM  \
                  AND PCA.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM  \
                  AND PCA.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM   \
                  AND PCA.SHIP_TO_CUSTOMER_NUM = COALESCE (PCA.SHIP_TO_CUSTOMER_NUM ,\
               PCA.SHIP_TO_CUSTOMER_NUM)  \
            LEFT OUTER JOIN \
               HSCSP_ODS.ACCT_PROD_USAGE APU2  \
                  ON APU2.CORP_ITEM_NUM = P.CORP_ITEM_NUM   \
                  AND APU2.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM  \
                  AND APU2.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM  \
                  AND APU2.AMU_CALC_TYPE_CDE = PAR1.APU_RECORD_AMU_CALC_TYPE_CDE    \
            LEFT OUTER JOIN \
               APE_DATA APE \
                  ON APE.PDCIN = P.CORP_ITEM_NUM   \
            LEFT OUTER JOIN \
               HSCSP_DDS.PD_SPD_ACCT_RLT XREF \
                  ON XREF.PD_SHIP_TO_CUST_NUM = ACC2.SHIP_TO_CUSTOMER_NUM \
                  AND XREF.PD_SHIP_TO_LOC_NUM = ACC2.SHIP_TO_LOCATION_NUM                \
            LEFT OUTER JOIN \
               HSCSP_CMDS.ACCT_STNG_ATRBT ASA    \
                  ON ASA.SHIP_TO_CUSTOMER_NUM = ACC2.SHIP_TO_CUSTOMER_NUM  \
                  AND ASA.SHIP_TO_LOCATION_NUM = ACC2.SHIP_TO_LOCATION_NUM   \
            LEFT OUTER JOIN \
               (\
                  SELECT \
                     AGFR.FORM_ID,\
                     AGRR.*  \
                  FROM \
                     HSCSP_CMDS.UOIF_ACCT_GROUP AG  \
                  INNER JOIN \
                     HSCSP_CMDS.UOIF_ACCT_GROUP_RULE_RLT AGRR    \
                        ON AG.ACCT_GROUP_NUM = AGRR.ACCT_GROUP_NUM  \
                  INNER JOIN \
                     HSCSP_CMDS.UOIF_ACCT_GROUP_FORM_RLT AGFR  \
                        ON AG.ACCT_GROUP_NUM = AGFR.ACCT_GROUP_NUM    \
                  where \
                     AG.SHIP_TO_CUSTOMER_NUM = ?  \
                     and AG.SHIP_TO_LOCATION_NUM = ?\
               ) as TEMP2  \
                  ON P.FORM_ID = TEMP2.FORM_ID  \
            WHERE \
               P.CORP_ITEM_NUM IN ( \
                  SELECT CORP_ITEM_NUM FROM HSCSP_DDS.PRODUCT where ITEM_TYPE_CDE = 24 and CORP_ITEM_NUM  <varCIN> \
               )    FOR FETCH ONLY WITH UR\


QUERY_NC=SELECT  \
   DISTINCT P.NON_CARD_PROD_NUM,  \
    ASA.DEFAULT_UOIF_TYPE_CDE    , \
   P.INVOICE_COST_DLR, PCA.UOIF_NUM,  \
   UHC.UNIT_H_ID,\
   P.PACK_QTY,\
   P.PACK_SIZE_NUM,CASE \
      WHEN UOIF_RULE_CNDTN_CDE = 1 THEN      (CASE \
         WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_NUM \
         WHEN UOIF_RULE_TYPE_1_CDE = 2 THEN P.PACK_QTY \
         WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_NUM*P.PACK_QTY \
         ELSE -1 \
      END)     \
      WHEN UOIF_RULE_CNDTN_CDE = 2 THEN (CASE \
         WHEN UOIF_PACK_CNDTN_CDE = 1 \
         and p.PACK_QTY = 1 THEN (CASE \
            WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_NUM \
            WHEN UOIF_RULE_TYPE_1_CDE = 2    THEN P.PACK_QTY \
            WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_NUM*P.PACK_QTY \
            ELSE -1 \
         END)     \
         WHEN UOIF_PACK_CNDTN_CDE = 1 \
         and p.PACK_QTY >1 THEN (CASE \
            WHEN UOIF_RULE_TYPE_2_CDE = 1 THEN P.PACK_SIZE_NUM \
            WHEN UOIF_RULE_TYPE_2_CDE = 2      THEN P.PACK_QTY \
            WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN P.PACK_SIZE_NUM*P.PACK_QTY \
            ELSE -1 \
         END)     \
         WHEN UOIF_PACK_CNDTN_CDE = 2 \
         and p.PACK_QTY = 1 THEN (CASE \
            WHEN UOIF_RULE_TYPE_2_CDE = 1 THEN P.PACK_SIZE_NUM \
            WHEN UOIF_RULE_TYPE_2_CDE = 2      THEN P.PACK_QTY \
            WHEN UOIF_RULE_TYPE_2_CDE = 3 THEN P.PACK_SIZE_NUM*P.PACK_QTY \
            ELSE -1 \
         END)     \
         WHEN UOIF_PACK_CNDTN_CDE = 2 \
         and p.PACK_QTY >1 THEN (CASE \
            WHEN UOIF_RULE_TYPE_1_CDE = 1 THEN P.PACK_SIZE_NUM \
            WHEN UOIF_RULE_TYPE_1_CDE = 2      THEN P.PACK_QTY \
            WHEN UOIF_RULE_TYPE_1_CDE = 3 THEN P.PACK_SIZE_NUM*P.PACK_QTY \
            ELSE -1 \
         END)    \
         ELSE -1 \
      END)     \
      ELSE -2 \
   END AS FORM_UOIF \
  \
FROM \
   HSCSP_CMDS.NON_CARD_PROD P \
LEFT OUTER JOIN \
   HSCSP_CMDS.PRODUCT_CUSTOM_ATTRIBUTE PCA  \
      ON (\
         PCA.NON_CARD_PROD_NUM = P.NON_CARD_PROD_NUM \
         AND  PCA.SHIP_TO_CUSTOMER_NUM = ?    \
         AND PCA.SHIP_TO_LOCATION_NUM = ?\
      ) \
LEFT JOIN \
   HSCSP_CMDS.ACCT_STNG_ATRBT ASA \
      ON (\
         ASA.SHIP_TO_CUSTOMER_NUM=PCA.SHIP_TO_CUSTOMER_NUM \
         AND ASA.SHIP_TO_LOCATION_NUM = PCA.SHIP_TO_LOCATION_NUM\
      )  \
LEFT OUTER JOIN \
   (\
      SELECT \
         AGFR.FORM_ID,\
         AGRR.*     \
      FROM \
         HSCSP_CMDS.UOIF_ACCT_GROUP AG,\
         HSCSP_CMDS.UOIF_ACCT_GROUP_RULE_RLT AGRR,\
         HSCSP_CMDS.UOIF_ACCT_GROUP_FORM_RLT AGFR      \
      where \
         AG.ACCT_GROUP_NUM = AGRR.ACCT_GROUP_NUM \
         AND  AG.ACCT_GROUP_NUM = AGFR.ACCT_GROUP_NUM      \
         AND AG.SHIP_TO_CUSTOMER_NUM = ? \
         and AG.SHIP_TO_LOCATION_NUM = ? \
   ) as temp \
      ON (\
         P.FORM_ID = temp.FORM_ID\
      ),\
   HSCSP_ODS.SALE_RANK  SR,\
   HSCSP_DDS.UNIT_H_CODE UHC  \
WHERE \
   P.ABC_RANK_CDE = SR.RANK_CDE \
   AND P.UNIT_H_CDE = UHC.UNIT_H_CDE \
   AND P.NON_CARD_PROD_NUM <varCIN> \
   FOR FETCH ONLY WITH UR          




######AD Factory 15.5 Release: Physical Inventory Import Performance Improvement - START ###### - Added By Shruti Sinha 
  
PHYSICAL_INV_MAX_LOCATION_DET = SELECT COUNT(loc.LOCATION_DETAIL_NUM) AS LOC_NUM_CNT, MAX(loc.SEQ_NUM) AS SEQ_NUM FROM OE_PI.LOCATION_DETAIL loc WHERE loc.LOCATION_NUM = ? 

JDBC_SCHEMA_NAME = OE_PI

PHYSICAL_INVENTORY_JNDI_CMDS = jdbc/PDS

PHYSICAL_INV_FETCH_CIN_QUERY_1 = SELECT CUSTOM_STOCK_ID, CORP_ITEM_NUM, NON_CARD_PROD_NUM FROM HSCSP_CMDS.PRODUCT_CUSTOM_ATTRIBUTE WHERE SHIP_TO_LOCATION_NUM = ? \
AND SHIP_TO_CUSTOMER_NUM = ? AND CUSTOM_STOCK_ID \

PHYSICAL_INVENTORY_GET_LOC_STAT_CDE = SELECT LOCATION_STAT_CDE FROM OE_PI.LOCATION WHERE LOCATION_NUM = ?

PHYSICAL_INV_INSERT_LOC_DET = INSERT INTO OE_PI.LOCATION_DETAIL \
(LOCATION_DETAIL_NUM, PROD_ID, COST_UOIF_NUM, CALC_TOTAL_VALUE_AMT, COUNT_TYPE_CDE, LOCATION_NUM, PROD_ID_TYPE_CDE, COST_AMT, \
CMNT_TXT, LINE_LEVEL_QTY, ROW_ADD_STP, ROW_ADD_USER_ID, ROW_UPDATE_STP, ROW_UPDATE_USER_ID, LAST_UPDATE_USER_NAM, \
MANUAL_COST_OVRD_AMT, SEQ_NUM) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

PHYSICAL_INV_NEXT_VAL = SELECT NEXTVAL FOR OE_PI.LOCATION_DETAIL_NUM_SEQ FROM SYSIBM.SYSDUMMY1 WITH UR

PHYSICAL_INV_DUPLICATE_CHECK_1 = SELECT LD.LOCATION_DETAIL_NUM,LD.COST_UOIF_NUM,CT.COUNT_TYPE_DESC,LD.PROD_ID_TYPE_CDE,LD.PROD_ID,PIT.PROD_ID_TYPE_DESC, LD.MANUAL_COST_OVRD_AMT, \
LD.COST_AMT, LD.LINE_LEVEL_QTY, LD.CMNT_TXT, LD.CALC_TOTAL_VALUE_AMT, LD.SEQ_NUM, LD.ROW_ADD_STP \
FROM OE_PI.LOCATION_DETAIL LD INNER JOIN OE_PI.COUNT_TYPE CT ON LD.COUNT_TYPE_CDE = CT.COUNT_TYPE_CDE \
INNER JOIN OE_PI.PROD_ID_TYPE PIT ON LD.PROD_ID_TYPE_CDE = PIT.PROD_ID_TYPE_CDE \
WHERE LD.LOCATION_NUM =?  AND LD.PROD_ID 

PHYSICAL_INV_DUPLICATE_CHECK_2 =  AND LD.LINE_LEVEL_QTY=0 ORDER BY LD.SEQ_NUM DESC 


PHYSICAL_INV_SELECT_LOC_DET = SELECT LD.LOCATION_DETAIL_NUM,LD.COST_UOIF_NUM,CT.COUNT_TYPE_DESC,LD.PROD_ID_TYPE_CDE,LD.PROD_ID,PIT.PROD_ID_TYPE_DESC, LD.MANUAL_COST_OVRD_AMT, \
LD.COST_AMT, LD.LINE_LEVEL_QTY, LD.CMNT_TXT, LD.CALC_TOTAL_VALUE_AMT, LD.SEQ_NUM, LD.ROW_ADD_STP \
FROM OE_PI.LOCATION_DETAIL LD INNER JOIN OE_PI.COUNT_TYPE CT ON LD.COUNT_TYPE_CDE = CT.COUNT_TYPE_CDE \
INNER JOIN OE_PI.PROD_ID_TYPE PIT ON LD.PROD_ID_TYPE_CDE = PIT.PROD_ID_TYPE_CDE \
WHERE LD.LOCATION_NUM = ? \
AND LD.LOCATION_DETAIL_NUM \

PHYSICAL_INV_LOC_TOT_AMT = SELECT SUM(loc.CALC_TOTAL_VALUE_AMT) AS totalAmount, COUNT(loc.LOCATION_DETAIL_NUM) AS total FROM OE_PI.LOCATION_DETAIL loc WHERE loc.LOCATION_NUM = ?

PHYSICAL_INV_UPDATE_LOC_QUERY_1 = UPDATE OE_PI.LOCATION loc SET loc.ROW_UPDATE_USER_ID = ?, loc.ROW_UPDATE_STP = ? WHERE loc.LOCATION_NUM = ?


######AD Factory 15.5 Release: Physical Inventory Import Performance Improvement - END ###### - Added By Shruti Sinha